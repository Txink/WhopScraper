# ============================================================
# Whop 平台配置
# ============================================================

# 监控页面配置（JSON 数组，启动时选择其中一个监控）
# 每项: url=页面URL, type=option(期权) 或 stock(正股)。每次运行仅监控一个页面。
PAGES=[
    {   
        "name":"期权页面",
        "url":"https://whop.com/joined/stock-and-option/-gZyq1MzOZAWO98/app/",
        "type":"options"
    },
    {
        "name":"正股页面",
        "url":"https://whop.com/joined/stock-and-option/-JG1I58S5zTHbxs/app/",
        "type":"stock"
    }
]

# 浏览器设置
HEADLESS=true                 # 是否无头模式运行
SLOW_MO=0                      # 浏览器操作延迟（毫秒）
# 监控消息：是否跳过首次连接时的历史消息（true=只处理连接后新消息，false=首次也处理当前页消息）
SKIP_INITIAL_MESSAGES=true
# 最近 5 条历史消息始终参与解析（例如便于重跑或补解析）
RECENT_MESSAGES_PARSE_COUNT=0
# 监控设置
MONITOR_MODE=poll              # 监控模式: event=事件驱动, poll=轮询模式
POLL_INTERVAL=0.2              # 轮询间隔（秒，仅在poll模式下使用）
STATUS_REPORT_INTERVAL=60      # 状态报告间隔（秒）

# 登录页面URL（一般不需要修改）
LOGIN_URL=https://whop.com/login/

# ============================================================
# LongPort 交易配置
# ============================================================

# 账户模式
LONGPORT_MODE=paper            # paper=模拟账户, real=真实账户

# API 凭据（模拟账户）
LONGPORT_PAPER_APP_KEY=xxxx
LONGPORT_PAPER_APP_SECRET=xxxx
LONGPORT_PAPER_ACCESS_TOKEN=xxxx

# API 凭据（真实账户）
LONGPORT_REAL_APP_KEY=xxxx
LONGPORT_REAL_APP_SECRET=xxxx
LONGPORT_REAL_ACCESS_TOKEN=xxxx

# LongPort 通用配置
LONGPORT_REGION=cn             # cn=中国大陆, hk=香港
LONGPORT_ENABLE_OVERNIGHT=true  # 是否开启夜盘行情

# 交易模式
LONGPORT_AUTO_TRADE=true      # 是否启用自动交易
LONGPORT_DRY_RUN=false          # 是否启用模拟模式（不实际下单）

# 期权默认止损（开启后：每次期权买入成交后自动按比例设止损，否则仅根据监听到的止损消息设置）
ENABLE_DEFAULT_STOP_LOSS=true   # true=开启默认止损
DEFAULT_STOP_LOSS_RATIO=38       # 止损比例（%），38 表示价格跌到买入价的 62% 时止损（即亏损 38% 触发）

# ============================================================
# 消息展示配置
# ============================================================

# 控制台展示模式
# raw: 仅显示原始消息
# parsed: 仅显示解析后的指令
# both: 同时显示原始消息和解析结果
DISPLAY_MODE=both

# 消息过滤配置
# 只处理指定作者的消息，多个作者用逗号分隔cl
# 留空则处理所有作者的消息
# FILTER_AUTHORS=xiaozhaolucky
FILTER_AUTHORS=

# 日志级别
LOG_LEVEL=INFO                 # DEBUG, INFO, WARNING, ERROR

# ============================================================
# 消息解析器配置
# ============================================================

# 上下文查找配置
# 当消息信息不完整时，向前查找的最大消息条数
CONTEXT_SEARCH_LIMIT=10

# ============================================================
# Parser层输出控制
# ============================================================

# 是否显示Parser层的指令解析输出
# 设置为 false 可以在broker下单时避免输出冲突
# 默认值: true
# 可选值: true, false, 1, 0, yes, no
SHOW_PARSER_OUTPUT=true

# ============================================================
# Broker层配置（自动交易）
# ============================================================

# 股票价格偏差容忍度（百分比）
# 买入时：若市场价不超过目标价此百分比，则使用市场价下单；否则使用目标价下单
# 默认值: 1（即市场价高于目标价不超过1%时用市场价）
STOCK_PRICE_DEVIATION_TOLERANCE=1

# 单个期权总价上限（美元）
# 买入时会根据此值和账户余额的较小值决定最大买入数量
# 默认值: 10000
MAX_OPTION_TOTAL_PRICE=2000

# 单次期权购买最大数量（张）
# 限制单次买入的期权合约数量
# 默认值: 10
MAX_OPTION_QUANTITY=20

# 价格偏差容忍度（百分比）
# 当市场价格与目标价格的偏差小于此值时，允许以市场价买入
# 默认值: 5
PRICE_DEVIATION_TOLERANCE=10

# 价格在容忍度内时买入用市价还是指令价
# instruction=用指令价（市价高于指令价时挂限价不超付，可能不成交）；market=用市价（优先成交，可能多付一点）
# 默认: instruction
BUY_PRICE_WHEN_WITHIN_TOLERANCE=market

# 是否需要控制台确认
# 启用后，每次下单前都需要在控制台确认
# 默认值: false
# 可选值: true, false, 1, 0, yes, no
REQUIRE_CONFIRMATION=false

# ============================================================
# 存储路径配置
# ============================================================

STORAGE_STATE_PATH=.auth/whop_cookie.json   # Cookie 存储路径
OUTPUT_FILE=output/signals.json           # 输出文件路径
POSITION_FILE=data/positions.json         # 持仓文件路径
LOG_DIR=logs                              # 日志目录

# ============================================================
# Telegram 确认（可选）
# ============================================================

# 是否启用 Telegram 确认：开启后，解析到交易指令会发到 Telegram Bot，带「确认/取消」按钮，
# 只有在 App 里点击确认后才会调用 longport 下单
# 默认值: false
TELEGRAM_ENABLED=false

# Telegram Bot Token（从 @BotFather 创建 Bot 后获得）
TELEGRAM_BOT_TOKEN=xxxx:xxxx

# 接收消息的 Chat ID（与 Bot 对话后，可从 getUpdates 或 @userinfobot 等获取）
TELEGRAM_CHAT_ID=xxxx
